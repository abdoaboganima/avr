/**
 *
 * @file       NOKIA5110_test.c
 * @brief      Contains some tests for the `NOKIA5110` module
 * @author     Abdulrahman Aboghanima
 * @date       Sun Aug 14 06:45:43 2022
 * @copyright  Copyright (c) 2022
 * @version    0.2
 * 
 */

#include "../HAL/NOKIA5110/NOKIA5110_interface.h"
#include "util/delay.h"
#include "../LIB/STD_TYPES.h"
#include "../LIB/BIT_MATH.h"


const uint8_t image[] = {
  0x00, 0x00, 0x00, 0x00, 0xB0, 0x78, 0x2C, 0x7E, 0x7E, 0x2C, 0x78, 0xB0, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xB0, 0x78, 0xAC, 0xBE, 0xBE, 0xAC, 0x78, 0xB0,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xB0, 0x78, 0x2C, 0x7E, 0x7E, 0x2C,
  0x78, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xB0, 0x78, 0xAC, 0xBE,
  0xBE, 0xAC, 0x78, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xB0, 0x78,
  0x2C, 0x7E, 0x7E, 0x2C, 0x78, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0xE0, 0xF0, 0xF0, 0xB1, 0xB8, 0xF8, 0xF8, 0xB8, 0xB1, 0xF0, 0xF0, 0xE0,
  0x00, 0x00, 0x00, 0x00, 0xE0, 0xF1, 0xF0, 0xB1, 0xB8, 0xF8, 0xF8, 0xB8, 0xB1, 0xF0,
  0xF1, 0xE0, 0x00, 0x00, 0x00, 0x00, 0xE0, 0xF0, 0xF0, 0xB1, 0xB8, 0xF8, 0xF8, 0xB8,
  0xB1, 0xF0, 0xF0, 0xE0, 0x00, 0x00, 0x00, 0x00, 0xE0, 0xF1, 0xF0, 0xB1, 0xB8, 0xF8,
  0xF8, 0xB8, 0xB1, 0xF0, 0xF1, 0xE0, 0x00, 0x00, 0x00, 0x00, 0xE0, 0xF0, 0xF0, 0xB1,
  0xB8, 0xF8, 0xF8, 0xB8, 0xB1, 0xF0, 0xF0, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x04, 0x04, 0x02, 0xA3, 0xC1, 0x81, 0x82, 0x82, 0x81, 0xC1, 0xA3, 0x02, 0x04,
  0x04, 0x00, 0x00, 0x04, 0x04, 0x02, 0xA3, 0xC1, 0x81, 0x82, 0x82, 0x81, 0xC1, 0xA3,
  0x02, 0x04, 0x04, 0x00, 0x00, 0x00, 0x00, 0x02, 0xA7, 0xC5, 0x81, 0x82, 0x82, 0x81,
  0xC5, 0xA7, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0xA7, 0xC5, 0x81, 0x82,
  0x82, 0x81, 0xC5, 0xA7, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x02, 0xA7, 0xC5,
  0x81, 0x82, 0x82, 0x81, 0xC5, 0xA7, 0x02, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x0E, 0x07, 0x0F, 0x16, 0x17, 0x07, 0x07, 0x17, 0x16, 0x0F, 0x07, 0x0E,
  0x00, 0x00, 0x00, 0x00, 0x0E, 0x07, 0x0F, 0x16, 0x17, 0x07, 0x07, 0x17, 0x16, 0x0F,
  0x07, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x07, 0x0F, 0x16, 0x17, 0x07, 0x07, 0x17,
  0x16, 0x0F, 0x07, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x07, 0x0F, 0x16, 0x17, 0x07,
  0x07, 0x17, 0x16, 0x0F, 0x07, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x03, 0x17, 0x0F, 0x06,
  0x07, 0x07, 0x07, 0x07, 0x06, 0x0F, 0x17, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xE0, 0xF0, 0xF8, 0xF8, 0x78, 0x38, 0x38,
  0x38, 0x38, 0x38, 0x38, 0x38, 0x38, 0x78, 0xF8, 0xF8, 0xF0, 0xE0, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0xE0, 0xF0, 0xF8, 0xF8, 0x78, 0x38, 0x38, 0x38, 0x38,
  0x38, 0x38, 0x38, 0x38, 0x78, 0xF8, 0xF8, 0xF0, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0xE0, 0xF0, 0xF8, 0xF8, 0x78, 0x38, 0x38, 0x38, 0x38, 0x38, 0x38,
  0x38, 0x38, 0x78, 0xF8, 0xF8, 0xF0, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xE0, 0xF0, 0xF0, 0xF0, 0xF0,
  0xFC, 0xFE, 0xFE, 0xFC, 0xF0, 0xF0, 0xF0, 0xF0, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

int main()
{
  /*Initialization*/
  NOKIA5110_init();

  /*Setting all bits of address(0, 0)*/
  NOKIA5110_sendData(0b11111111);

  /*Going to address(10, 1)*/
  NOKIA5110_setXY(10,1);

  /*Sending Data*/
  NOKIA5110_sendData(0b11111111);
  NOKIA5110_sendData(0b01010101);
  NOKIA5110_sendData(0b10101010);
  NOKIA5110_sendData(0b01010101);
  NOKIA5110_sendData(0b10101010);
  NOKIA5110_sendData(0b01010101);
  NOKIA5110_sendData(0b10101010);
  _delay_ms(100);

  /*Setting Inverse video mode after some delay*/
  NOKIA5110_setInverseVideoMode();

  /*Sending data in then in the inverse mode*/
  NOKIA5110_setXY(0, 2);           /*Going to address(0, 2)*/
  NOKIA5110_sendData(0b11111111);  /*Will see no difference because of inverse mode*/
  NOKIA5110_sendData(0b00000000);
  NOKIA5110_sendData(0b01010101);
  NOKIA5110_sendData(0b10101010);
  _delay_ms(100);

  

  /*Setting blank mode*/
  NOKIA5110_setBlankMode();

  /*Sending data in blank mode*/
  NOKIA5110_setXY(0, 3);          /*Going to address(0, 3)*/
  NOKIA5110_sendData(0b11111111);
  NOKIA5110_sendData(0b00000000);
  NOKIA5110_sendData(0b01010101);
  NOKIA5110_sendData(0b10101010);
  _delay_ms(100);



  /*Setting Normal Mode, Should */
  NOKIA5110_setNormalMode(); /*Is there any difference in the line3*/
  _delay_ms(1000);

  NOKIA5110_clearDisplay();
  _delay_ms(100);


  
  NOKIA5110_sendString("HELLO");
  NOKIA5110_setXY(0, 1);
  NOKIA5110_sendString("NOKIA5110! :)");
  NOKIA5110_setXY(0, 2);
  NOKIA5110_sendString("WELCOME TO MY");
  NOKIA5110_setXY(0, 3);
  NOKIA5110_sendString("Repo");
  NOKIA5110_setXY(0, 5);
  NOKIA5110_sendString("@abdoaboganima");
  _delay_ms(6000);
  
  NOKIA5110_clearDisplay();
  NOKIA5110_drawFullImage(image);
  _delay_ms(4000);

  while(1){
    _delay_ms(100);
    NOKIA5110_sendData(0b11111111);
    _delay_ms(100);
    NOKIA5110_sendData(0b00000000);
  
  }
  return 0;
}
